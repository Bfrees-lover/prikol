"# Проект Самарин Сережкин - Ставки на спорт

Платформа для ставок на спорт с рандомизированными событиями и системой коэффициентов, разработанная по требованиям проекта Самарин Сережкин.

## Особенности

1. **Рандомизированные события** - Генерация случайных спортивных событий в различных дисциплинах
2. **Логика коэффициентов** - Динамические коэффициенты, зависящие от количества ставок на каждый исход
3. **Админка** - Панель управления с аналитикой, отображением процента букмекера и общего депозита сервиса
4. **Блокировка при выводе** - Кнопка вывода средств временно блокирует действия пользователя на 30 секунд
5. **Минимум 3 дисциплины** - Поддержка футбола, баскетбола, тенниса и других видов спорта
6. **Роли пользователей** - Разграничение прав между обычными пользователями и администраторами
7. **Интеграция с Rebit Emcy** - Использование Rebit Emcy в качестве брокера

## Архитектура

- **FastAPI** - Веб-фреймворк
- **SQLAlchemy** - ORM для работы с базой данных
- **SQLite** - Локальная база данных (в продакшене рекомендуется PostgreSQL)
- **Redis** - Для хранения сессий и временных данных
- **JWT** - Аутентификация пользователей

## Установка

```bash
# Клонирование репозитория
git clone <repository-url>
cd betting-platform

# Установка зависимостей
pip install -r requirements.txt

# Запуск приложения
uvicorn main:app --reload
```

## Использование Docker

```bash
# Сборка образа
docker build -t betting-platform .

# Запуск контейнера
docker run -p 8000:8000 betting-platform
```

## API Endpoints

### Аутентификация
- `POST /api/v1/register` - Регистрация пользователя
- `POST /api/v1/login` - Авторизация пользователя

### Пользовательские операции
- `GET /api/v1/user/profile` - Профиль пользователя
- `GET /api/v1/user/balance` - Баланс пользователя
- `POST /api/v1/user/withdraw` - Вывод средств
- `GET /api/v1/events` - Получить доступные события
- `POST /api/v1/bet/place` - Сделать ставку

### Административные операции
- `GET /api/v1/admin/analytics` - Аналитика для администратора
- `GET /api/v1/admin/users` - Список всех пользователей
- `GET /api/v1/admin/events` - Список всех событий

## Структура проекта

```
/workspace/
├── main.py                 # Главный файл приложения
├── config.py              # Конфигурационные параметры
├── requirements.txt       # Зависимости
├── Dockerfile             # Файл для Docker
├── README.md              # Документация
└── src/                   # Основной код приложения
    ├── models/            # Модели базы данных
    ├── services/          # Бизнес-логика
    ├── api/               # API маршруты
    ├── admin/             # Административные функции
    ├── user/              # Пользовательские функции
    └── utils/             # Вспомогательные функции
```

## Реализованные функции

### 1. Рандомизированные события
Система генерирует случайные спортивные события в следующих дисциплинах:
- Футбол
- Баскетбол  
- Теннис
- Хоккей
- Волейбол

### 2. Логика коэффициентов
Коэффициенты изменяются в зависимости от количества ставок на каждый исход:
- Чем больше ставок на определенный исход, тем ниже коэффициент
- Применяется маржа букмекера (по умолчанию 5%)

### 3. Админка
Панель администратора предоставляет:
- Процент букмекера
- Общий депозит сервиса
- Депозиты каждого игрока
- Аналитику активности

### 4. Блокировка действий при выводе
При нажатии кнопки "Вывести деньги":
- Пользователь блокируется на 30 секунд
- Все действия пользователя невозможны в течение этого времени

### 5. Поддержка нескольких дисциплин
Система поддерживает как минимум 3 спортивные дисциплины:
- Футбол
- Баскетбол
- Теннис

### 6. Ролевая система
- `user` - Обычный пользователь
- `admin` - Администратор с расширенными правами

### 7. Интеграция с Rebit Emcy
Предусмотрена интеграция с Rebit Emcy в качестве брокера (реализация в конфигурации).

## Безопасность

- Защита паролей с использованием bcrypt
- JWT-токены для аутентификации
- Валидация входных данных
- Защита от SQL-инъекций через SQLAlchemy

## Лицензия

Проект создан в рамках учебного задания проекта Самарин Сережкин."
 
